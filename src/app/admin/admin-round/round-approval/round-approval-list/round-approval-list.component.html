<app-loader [loader]="loader"></app-loader>
<section class="content">
  <div 
  style="padding: 40px 20px;"
  *ngIf="!loader">
    <h1 style="color: #1F1F1F;">Empresas</h1>
    <p style="color: #505050;">Verifique aqui todas as empresas da plataforma.</p>

    <div style="width: 100%; border-radius: 4px; background-color: white; margin-top: 40px; padding: 20px 0">
      <p style="margin-left: 16px; font-size: 16px;">Empresas</p>

      <div style="width: 100%; margin-top: 35px; border-bottom: 1px solid #E5E5E5;">
        <div style="width: 100%; display: flex; align-items: center; justify-content: space-between; padding: 0 20px;">
          <div style="display: flex; align-items: center; gap: 32px;">
            <p (click)="setStatus('APPROVED')" 
            [ngStyle]="{'color': status === 'APPROVED' ? '#035A7A' : '#000000'}"
              style="cursor: pointer;">
              Empresas ativas
            </p>
            <p (click)="setStatus('PENDING_EVALUATION')" 
            [ngStyle]="{'color': status === 'PENDING_EVALUATION' ? '#035A7A' : '#000000'}"
              style="cursor: pointer;">
              Empresas inativas
            </p>
          </div>
          
          <div
            style="height: 2.5em; width: 30%; display: flex; align-items: center; border-radius: 4px; border: 1px solid #E5E5E5; background-color: #FAFAFA; gap: 5px; padding: 0 16px; margin-bottom: 10px;">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M6.12502 11.0837C8.86342 11.0837 11.0834 8.86373 11.0834 6.12533C11.0834 3.38693 8.86342 1.16699 6.12502 1.16699C3.38662 1.16699 1.16669 3.38693 1.16669 6.12533C1.16669 8.86373 3.38662 11.0837 6.12502 11.0837Z"
                stroke="#777777" stroke-width="1.5" stroke-linejoin="round" />
              <path d="M9.68964 9.68945L12.1645 12.1643" stroke="#777777" stroke-width="1.5" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
            <input
              style="background-color: transparent; border: 0; width: 100%; text-decoration: none; outline: none; margin-left: 5%;"
              placeholder="Pesquisar empresas" (input)="filterCompanies($event.target.value)" />
          </div>
          
          <div style="display: flex; align-items: center; gap: 10px;">
            <button style="width: 140px; height: 36px; border: 1px solid #035A7A; border-radius: 4px; display: flex; align-items: center; justify-content: center; gap: 10px; margin-bottom: 10px; background-color: white;">
              <p style="margin-bottom: 0; color: #035A7A;">Exportar</p>

              <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M2 8.00277V14H14V8" stroke="#035A7A" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                <path d="M11 7.66602L8 10.666L5 7.66602" stroke="#035A7A" stroke-width="1.5" stroke-linecap="round"
                  stroke-linejoin="round" />
                <path d="M7.99724 2V10.6667" stroke="#035A7A" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
            </button>

            <button
              style=" height: 36px; background-color: #035A7A; border-radius: 4px; display: flex; align-items: center; justify-content: center; padding: 0px 32px; margin-bottom: 10px;">
              <p style="margin-bottom: 0; color: white;">Cadastrar empresa +</p>
            </button>
          </div>
        </div>

      </div>

      <table style="width: 100%; margin-top: 35px;">
        <tr >
          <th style="padding-left: 16px; font-family: Poppins, sans-serif; font-weight: 400;">Empresa</th>
          <th style="padding-left: 16px; font-family: Poppins, sans-serif; font-weight: 400;">Nome do responsável</th>
          <th style="padding-left: 16px; font-family: Poppins, sans-serif; font-weight: 400;">CNPJ</th>
          <th style="padding-left: 16px; font-family: Poppins, sans-serif; font-weight: 400;">Modelo</th>
        </tr>

        <tr [ngClass]="{'even-row': i % 2 === 0, 'odd-row': i % 2 !== 0}"
          style="border-top: 1px solid #F1F1F1; border-bottom: 1px solid #F1F1F1; cursor: auto;"
          *ngFor="let company of filteredCompanies | paginate: { itemsPerPage: itemsPerPage, currentPage: currentPage }; let i = index">
          <td style="padding: 16px; font-family: Poppins, sans-serif; font-weight: 500;">{{ company.name }}</td>
          <td style="padding: 16px; font-family: Poppins, sans-serif; font-weight: 400;">{{ company.responsible.name }}</td>
          <td style="padding: 16px; font-family: Poppins, sans-serif; font-weight: 400;">{{ company.cnpj | cnpj }}</td>
          <td style="padding: 16px; font-family: Poppins, sans-serif; font-weight: 400; color: #035A7A;">
            <span>{{ maskModel(company.model) }}</span>
          </td>
          <td style="padding: 16px; font-family: Poppins, sans-serif; font-weight: 400; position: relative;">
            <svg class="hover-svg" style="cursor: pointer;" width="20" height="20" viewBox="0 0 20 20" fill="none"
              xmlns="http://www.w3.org/2000/svg" (click)="toggleDropdown(i)">
              <path
                d="M10 16.6673C9.07953 16.6673 8.33334 15.9211 8.33334 15.0007C8.33334 14.0802 9.07953 13.334 10 13.334C10.9205 13.334 11.6667 14.0802 11.6667 15.0007C11.6667 15.9211 10.9205 16.6673 10 16.6673ZM10 11.6673C9.07953 11.6673 8.33334 10.9211 8.33334 10.0007C8.33334 9.08018 9.07953 8.33398 10 8.33398C10.9205 8.33398 11.6667 9.08018 11.6667 10.0007C11.6667 10.4427 11.4911 10.8666 11.1785 11.1792C10.866 11.4917 10.442 11.6673 10 11.6673ZM10 6.66732C9.07953 6.66732 8.33334 5.92113 8.33334 5.00065C8.33334 4.08018 9.07953 3.33398 10 3.33398C10.9205 3.33398 11.6667 4.08018 11.6667 5.00065C11.6667 5.44268 11.4911 5.8666 11.1785 6.17916C10.866 6.49172 10.442 6.66732 10 6.66732Z"
                fill="#909090" />
            </svg>

            <div *ngIf="isDropdownVisible === i"
              style="position: absolute; top: 40px; right: 40px; width: 175px; background-color: white; border-radius: 4px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); z-index: 999; padding: 12px 16px;">
              <div 
             class="hover-background" 
              style="display: flex; gap: 16px; align-items: center; border-bottom: 1px solid #E5E5E5; padding-bottom: 5px; margin-bottom: 10px; cursor: pointer;">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M14 2.66602V7.99935" stroke="#505050" stroke-width="1.66667" stroke-linecap="round"
                    stroke-linejoin="round" />
                  <path d="M2 8V13.3333" stroke="#505050" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
                  <path
                    d="M14 8C14 4.6863 11.3137 2 8 2C6.30483 2 4.77387 2.70299 3.6827 3.83333M2 8C2 11.3137 4.6863 14 8 14C9.61853 14 11.0874 13.3591 12.1667 12.3173"
                    stroke="#505050" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
                <p style="margin-bottom: 0;">Atualizações</p>
              </div>
              <div 
              class="hover-background"
              style="display: flex; gap: 16px; align-items: center; padding-bottom: 5px; margin-bottom: 10px; cursor: pointer;">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M1.77499 14.5L4.60333 14.5001L14.9742 4.12919L12.1458 1.30078L1.7749 11.6717L1.77499 14.5Z" stroke="#505050"
                    stroke-width="1.5" stroke-linejoin="round" />
                  <path d="M9.31735 4.12891L12.1458 6.95734" stroke="#505050" stroke-width="1.5" stroke-linecap="round"
                    stroke-linejoin="round" />
                </svg>
                <p style="margin-bottom: 0;">Editar</p>
              </div>

              <div 
              class="hover-background"
              style="display: flex; gap: 16px; align-items: center; padding-bottom: 5px; margin-bottom: 10px; cursor: pointer;">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <g clip-path="url(#clip0_1028_3073)">
                    <path
                      d="M8.00001 14.6673C9.84094 14.6673 11.5076 13.9211 12.714 12.7147C13.9205 11.5083 14.6667 9.84158 14.6667 8.00065C14.6667 6.15972 13.9205 4.49305 12.714 3.2866C11.5076 2.08018 9.84094 1.33398 8.00001 1.33398C6.15908 1.33398 4.49241 2.08018 3.28596 3.2866C2.07954 4.49305 1.33334 6.15972 1.33334 8.00065C1.33334 9.84158 2.07954 11.5083 3.28596 12.7147C4.49241 13.9211 6.15908 14.6673 8.00001 14.6673Z"
                      stroke="#505050" stroke-width="1.5" stroke-linejoin="round" />
                    <rect x="5" y="7" width="6" height="2" rx="1" fill="#505050" />
                  </g>
                  <defs>
                    <clipPath id="clip0_1028_3073">
                      <rect width="16" height="16" fill="white" />
                    </clipPath>
                  </defs>
                </svg>
                <p style="margin-bottom: 0;">Inativar</p>
              </div>

              <div class="hover-background"
                style="display: flex; gap: 16px; align-items: center; padding-bottom: 5px; cursor: pointer;">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M5 3.99935L5.4 1.66602H10.6L11 3.99935" stroke="#FF3A44" stroke-width="1.5" stroke-linejoin="round" />
                  <path d="M2 4H14" stroke="#FF3A44" stroke-width="1.5" stroke-linecap="round" />
                  <path fill-rule="evenodd" clip-rule="evenodd" d="M12.3333 4L11.6667 14.3333H4.33332L3.66666 4H12.3333Z"
                    stroke="#FF3A44" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                  <path d="M6.33334 11.666H9.66668" stroke="#FF3A44" stroke-width="1.5" stroke-linecap="round" />
                </svg>
                <p style="margin-bottom: 0; color: red;">Excluir</p>
              </div>
            </div>
          </td>
        </tr>
        
      </table>

      <div style="width: 100%; display: flex; justify-content: center; margin-top: 50px; align-items: center; gap: 32px;">
        <p (click)="changePage(currentPage - 1)" [ngClass]="{'disabled': currentPage === 1}"
          style="font-family: Poppins, sans-serif; font-weight: 400; color: #909090; margin-bottom: 0; cursor: pointer;">
          Anterior</p>
        <div style="display: flex; align-items: center; gap: 15px;">
          <div *ngFor="let page of [].constructor(totalPages); let i = index" (click)="changePage(i + 1)"
            [ngClass]="{'active-page': currentPage === i + 1}"
            [style.background-color]="currentPage === i + 1 ? '#035A7A' : 'transparent'"
            style="width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; border-radius: 4px; cursor: pointer;">
            <p [style.color]="currentPage === i + 1 ? 'white' : '#909090'"
              style="font-family: Poppins, sans-serif; font-weight: 400; margin-bottom: 0;">
              {{ i + 1 }}</p>
          </div>
        </div>
        <p (click)="changePage(currentPage + 1)" [ngClass]="{'disabled': currentPage === totalPages}"
          [ngStyle]="{'cursor': currentPage === totalPages ? 'not-allowed' : 'pointer'}"
          style="font-family: Poppins, sans-serif; font-weight: 500; color: #035A7A; margin-bottom: 0;">
          Próximo
        </p>
      </div>
    </div>
  </div>
</section>
